"use strict";(self.webpackChunkecommerce_application=self.webpackChunkecommerce_application||[]).push([[106],{429:(e,t,s)=>{s.d(t,{Z:()=>o});var i=s(37),a=s(683),r=s(233);class o{constructor(e){if(this.clientRoot=(0,i.mv)((0,a.p0)()).withProjectKey({projectKey:"best-games"}),this.createCart=e=>this.clientRoot.carts().post({body:{key:`cart-key-${Math.floor(1e5*Math.random())}`,currency:"RUB",country:"RU",customerId:e}}).execute(),e){const t=(0,r.r4)(e.email,e.password);this.clientRoot=(0,i.mv)(t).withProjectKey({projectKey:"best-games"})}}checkCustomerExist(e){return this.returnCustomerByEmail(e).then((e=>e))}returnCustomerByEmail(e){return this.clientRoot.customers().get({queryArgs:{where:`email="${e}"`}}).execute()}returnCustomerById(e){return this.clientRoot.customers().get({queryArgs:{where:`id="${e}"`}}).execute()}getCustomer({email:e,password:t}){return this.clientRoot.me().login().post({body:{email:e,password:t,updateProductData:!0}}).execute()}createUserRoot(e,t){const s=(0,r.r4)(e,t);return this.clientRoot=(0,i.mv)(s).withProjectKey({projectKey:"best-games"}),this.clientRoot}getCartByCustomerId(e){return this.clientRoot.carts().withCustomerId({customerId:e}).get().execute()}createCustomerDraft(e){const{email:t,password:s,firstName:i,lastName:a,countryCode:r,key:o}=e;return{email:t,password:s,key:o,firstName:i,lastName:a,addresses:[{country:r}],defaultShippingAddress:0}}createCustomer(e){try{return this.clientRoot.customers().post({body:this.createCustomerDraft(e)}).execute()}catch(e){return e}}}},683:(e,t,s)=>{s.d(t,{p0:()=>r});var i=s(631);const a="best-games",r=()=>{const e={host:"https://auth.europe-west1.gcp.commercetools.com",projectKey:a,credentials:{clientId:"A8PxwfHMEiItZ24oahyDGO2A",clientSecret:"RKi7doGwQ75b4wfuLsPuahDT366uOhUY",anonymousId:`best-games-${Math.floor(1e5*Math.random())}`},scopes:[`manage_project:${a}`]},t={host:"https://api.europe-west1.gcp.commercetools.com",fetch};return(new i.Qx).withAnonymousSessionFlow(e).withProjectKey(a).withHttpMiddleware(t).withLoggerMiddleware().build()}},233:(e,t,s)=>{s.d(t,{r4:()=>r});var i=s(631);const a="best-games",r=(e,t)=>{const s={host:"https://auth.europe-west1.gcp.commercetools.com",projectKey:a,credentials:{clientId:"A8PxwfHMEiItZ24oahyDGO2A",clientSecret:"RKi7doGwQ75b4wfuLsPuahDT366uOhUY",user:{username:e,password:t}},scopes:[`manage_project:${a}`],fetch},r={host:"https://api.europe-west1.gcp.commercetools.com",fetch};return(new i.Qx).withPasswordFlow(s).withProjectKey(a).withHttpMiddleware(r).withLoggerMiddleware().build()}},106:(e,t,s)=>{s.d(t,{getView:()=>N});var i=s(429),a=s(567),r=s(602),o=s(928);const n={"login-view":"login-view--xYXHF","registration-field":"registration-field--rfaSb","login-title":"login-title--ZnrER","registration-field__title":"registration-field__title--IH0AX","login-subtitle":"login-subtitle--Bhb9b","login-form":"login-form--JFEMt","login-form__show-password":"login-form__show-password--r1rU6","login-form__popup":"login-form__popup--Td1nV","password-block":"password-block--dqC0n",button:"button--KUb8s",field:"field--_0gSU",disabled:"disabled--LALv4"};var l=s(296),m=s(881),d=s(891);const c=/(?=.*[0-9])/g,u=/(?=.*[a-z])/,h=/(?=.*[A-Z])/,E=/(?=.*[!@#$%^&*])/,w=/[0-9a-zA-Z!@#$%^&*]{8,}/,p=/[^\s]/gim,g=/[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}/;var I;!function(e){e.FILL_EMAIL="Please fill the field email.",e.FILL_PASSWORD="Please fill the field password.",e.MAIL_NOT_REGISTERED="This email address has not been registered.",e.SUCCESS_LOGIN="Welcome! You are logged!.",e.PASSWORD_IS_WRONG="Password is wrong!",e.EMAIL_CONTAIN_WHITESPACE="Email address must not contain leading or trailing whitespace.",e.EMAIL_WRONG_FORMAT="Email address must be properly formatted (e.g., user@example.com).",e.PASSWORD_CONTAIN_WHITESPACE="Password must not contain leading or trailing whitespace.",e.PASSWORD_NOT_CONTAIN_DIGIT="Password must contain at least one digit (0-9).",e.PASSWORD_NOT_CONTAIN_LOWER_LETTER="Password must contain at least one lowercase letter (a-z).",e.PASSWORD_NOT_CONTAIN_UPPER_LETTER="Password must contain at least one uppercase letter (A-Z).",e.PASSWORD_NOT_CONTAIN_SIMBOLS="Password must contain at least one special character (e.g., !@#$%^&*).",e.PASSWORD_LENGTH_NOT_ENOUTH="Password must be at least 8 characters long."}(I||(I={}));class _ extends o.Z{constructor(e){super({tag:a.Z.SECTION,classNames:[n["login-view"]],textContent:""}),this.loginEmail=new r.Z({tag:a.Z.INPUT,classNames:[n.field],textContent:"email"}),this.loginPassword=new r.Z({tag:a.Z.INPUT,classNames:[n.field],textContent:"password"}),this.passwordElement=this.loginPassword.getElement(),this.emailElement=this.loginEmail.getElement(),this.router=e,this.observer=l.Z.getInstance(),this.observer?.subscribe(m.Z.LOGOUT,this.updateLoginPage.bind(this)),this.anonimApi=new i.Z,"true"===localStorage.getItem("isLogin")?this.router.navigate(d._.INDEX):this.configView()}configView(){this.renderForm()}updateLoginPage(){this.getCreator().clearInnerContent(),this.configView(),this.anonimApi=new i.Z}renderForm(){const e=new r.Z({tag:a.Z.SPAN,classNames:[n["login-title"]],textContent:"EXISTING CUSTOMERS"}),t=new r.Z({tag:a.Z.SPAN,classNames:[n["login-subtitle"]],textContent:"Sign Into Best Games"}),s=new r.Z({tag:a.Z.DIV,classNames:[n["login-form"]],textContent:""}),i=new r.Z({tag:a.Z.DIV,classNames:[n["password-block"]],textContent:""}),o=new r.Z({tag:a.Z.BUTTON,classNames:[n.button],textContent:"SHOW"}),l=new r.Z({tag:a.Z.BUTTON,classNames:[n.button],textContent:"SIGN IN"}),m=new r.Z({tag:a.Z.DIV,classNames:[n["registration-field"]],textContent:""}),c=new r.Z({tag:a.Z.SPAN,classNames:[n["registration-field__title"]],textContent:"NEW CUSTOMERS"}),u=new r.Z({tag:a.Z.BUTTON,classNames:[n["register-link"],n.button],textContent:"REGISTER NOW"});s.getElement().setAttribute("action","#"),this.emailElement.setAttribute("type","email"),this.emailElement.setAttribute("name","email"),this.emailElement.setAttribute("placeholder","email"),this.emailElement.setAttribute("Required","true"),this.passwordElement.setAttribute("type","password"),this.passwordElement.setAttribute("name","password"),this.passwordElement.setAttribute("placeholder","password"),this.passwordElement.setAttribute("Required","true"),this.emailElement.addEventListener("input",(()=>this.validateEmail())),this.passwordElement.addEventListener("input",(()=>this.validatePassword())),o.getElement().addEventListener("click",(e=>this.showPassword(e))),l.getElement().addEventListener("click",(e=>this.submitLogin(e))),u.getElement().addEventListener("click",(()=>{this.router.navigate(d._.REGISTRATION)})),s.addInnerElement(e),s.addInnerElement(t),s.addInnerElement(this.loginEmail),i.addInnerElement(this.loginPassword),i.addInnerElement(o),s.addInnerElement(i),s.addInnerElement(l),m.addInnerElement(c),m.addInnerElement(u),this.getCreator().addInnerElement(s),this.getCreator().addInnerElement(m)}showPassword(e){e.preventDefault(),"password"===this.passwordElement.getAttribute("type")?this.passwordElement.setAttribute("type","text"):this.passwordElement.setAttribute("type","password")}async submitLogin(e){e.preventDefault();const t=this.emailElement.value,s=this.passwordElement.value;if(t||(this.emailElement.setCustomValidity(I.FILL_EMAIL),this.emailElement.reportValidity()),s||(this.passwordElement.setCustomValidity(I.FILL_PASSWORD),this.passwordElement.reportValidity()),0!==t.length&&0!==s.length&&this.validatePassword()&&this.validateEmail()){if(void 0!==t)try{if(0===(await this.anonimApi.checkCustomerExist(t)).body.results.length)return this.emailElement.setCustomValidity(I.MAIL_NOT_REGISTERED),void this.emailElement.reportValidity()}catch(e){e instanceof Error&&console.log(e.message)}this.anonimApi.getCustomer({email:t,password:s}).then((e=>{e.body.customer&&(window.localStorage.setItem("isLogin","true"),this.observer.notify(m.Z.LOGIN),this.router.navigate(d._.INDEX),this.userApi=new i.Z({email:t,password:s}),this.userApi.returnCustomerById(e.body.customer.id))})).catch((()=>{this.passwordElement.setCustomValidity(I.PASSWORD_IS_WRONG),this.passwordElement.reportValidity()}))}}validateEmail(){const{value:e}=this.emailElement;switch(this.emailElement.setCustomValidity(""),!0){case!p.test(e):case e.indexOf(" ")>-1:this.emailElement.setCustomValidity(I.EMAIL_CONTAIN_WHITESPACE);break;case!g.test(e):this.emailElement.setCustomValidity(I.EMAIL_WRONG_FORMAT);break;default:return this.emailElement.setCustomValidity(""),!0}return this.emailElement.reportValidity(),!1}validatePassword(){const{value:e}=this.passwordElement;switch(this.passwordElement.setCustomValidity(""),!0){case!p.test(e):this.passwordElement.setCustomValidity(I.PASSWORD_CONTAIN_WHITESPACE);break;case!c.test(e):this.passwordElement.setCustomValidity(I.PASSWORD_NOT_CONTAIN_DIGIT);break;case!u.test(e):this.passwordElement.setCustomValidity(I.PASSWORD_NOT_CONTAIN_LOWER_LETTER);break;case!h.test(e):this.passwordElement.setCustomValidity(I.PASSWORD_NOT_CONTAIN_UPPER_LETTER);break;case!E.test(e):this.passwordElement.setCustomValidity(I.PASSWORD_NOT_CONTAIN_SIMBOLS);break;case!w.test(e):this.passwordElement.setCustomValidity(I.PASSWORD_LENGTH_NOT_ENOUTH);break;default:return this.passwordElement.setCustomValidity(""),!0}return this.passwordElement.reportValidity(),!1}createMessagePopup(e){const t=new r.Z({tag:a.Z.DIV,classNames:[n["login-form__popup"]],textContent:e});this.getCreator().addInnerElement(t),t.getElement().addEventListener("click",(()=>{t.getElement().remove()}))}}function N(e){return new _(e)}}}]);