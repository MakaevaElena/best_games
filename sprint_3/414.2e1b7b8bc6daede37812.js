"use strict";(self.webpackChunkecommerce_application=self.webpackChunkecommerce_application||[]).push([[414],{414:(t,e,s)=>{s.r(e),s.d(e,{default:()=>A});var i=s(429),a=s(567),n=s(602),l=s(928);const r={"login-view":"xYXHFePTM2S0dqGs8NAJ","registration-field":"rfaSbxM4Zpq5qjmIdWrR","login-title":"ZnrER3UrOlve2edKp4AT","registration-field__title":"IH0AXml7UqTRWuNoccnr","login-subtitle":"Bhb9b1wjunWV_jDRMiSP","login-form":"JFEMty0UDQZmna7dRVcX","login-form__show-password":"r1rU6ErdsCezKaRBX1Rf","password-block":"dqC0nDhMuBIw9EL5S094",button:"KUb8sryclIp2QNB2Ayzn",field:"_0gSUI4HCMIb6rkXELp3",disabled:"LALv42c2_SMw6Ue5xDUR"};var o=s(296),d=s(881),m=s(891),E=s(953);const h=/(?=.*[0-9])/g,c=/(?=.*[a-z])/,u=/(?=.*[A-Z])/,w=/(?=.*[!@#$%^&*])/,g=/[0-9a-zA-Z!@#$%^&*]{8,}/,p=/[^\s]/gim,I=/[a-z0-9]+[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}/;var N;!function(t){t.FILL_EMAIL="Please fill the field email.",t.FILL_PASSWORD="Please fill the field password.",t.MAIL_NOT_REGISTERED="This email address has not been registered.",t.SUCCESS_LOGIN="Welcome! You are logged!.",t.PASSWORD_IS_WRONG="Password is wrong!",t.EMAIL_CONTAIN_WHITESPACE="Email address must not contain leading or trailing whitespace.",t.EMAIL_WRONG_FORMAT="Email address must be properly formatted (e.g., user@example.com).",t.PASSWORD_CONTAIN_WHITESPACE="Password must not contain leading or trailing whitespace.",t.PASSWORD_NOT_CONTAIN_DIGIT="Password must contain at least one digit (0-9).",t.PASSWORD_NOT_CONTAIN_LOWER_LETTER="Password must contain at least one lowercase letter (a-z).",t.PASSWORD_NOT_CONTAIN_UPPER_LETTER="Password must contain at least one uppercase letter (A-Z).",t.PASSWORD_NOT_CONTAIN_SIMBOLS="Password must contain at least one special character (e.g., !@#$%^&*).",t.PASSWORD_LENGTH_NOT_ENOUTH="Password must be at least 8 characters long."}(N||(N={}));class A extends l.Z{constructor(t){super({tag:a.Z.SECTION,classNames:[r["login-view"]],textContent:""}),this.loginEmail=new n.Z({tag:a.Z.INPUT,classNames:[r.field],textContent:"email"}),this.loginPassword=new n.Z({tag:a.Z.INPUT,classNames:[r.field],textContent:"password"}),this.passwordElement=this.loginPassword.getElement(),this.emailElement=this.loginEmail.getElement(),this.router=t,this.observer=o.Z.getInstance(),this.observer?.subscribe(d.Z.LOGOUT,this.updateLoginPage.bind(this)),this.anonimApi=new i.Z,"true"===localStorage.getItem("isLogin")?this.router.navigate(m._.INDEX):this.configView()}configView(){this.renderForm()}updateLoginPage(){this.getCreator().clearInnerContent(),this.configView(),this.anonimApi=new i.Z}renderForm(){const t=new n.Z({tag:a.Z.SPAN,classNames:[r["login-title"]],textContent:"EXISTING CUSTOMERS"}),e=new n.Z({tag:a.Z.SPAN,classNames:[r["login-subtitle"]],textContent:"Sign Into Best Games"}),s=new n.Z({tag:a.Z.DIV,classNames:[r["login-form"]],textContent:""}),i=new n.Z({tag:a.Z.DIV,classNames:[r["password-block"]],textContent:""}),l=new n.Z({tag:a.Z.BUTTON,classNames:[r.button],textContent:"SHOW"}),o=new n.Z({tag:a.Z.BUTTON,classNames:[r.button],textContent:"SIGN IN"}),d=new n.Z({tag:a.Z.DIV,classNames:[r["registration-field"]],textContent:""}),E=new n.Z({tag:a.Z.SPAN,classNames:[r["registration-field__title"]],textContent:"NEW CUSTOMERS"}),h=new n.Z({tag:a.Z.BUTTON,classNames:[r["register-link"],r.button],textContent:"REGISTER NOW"});s.getElement().setAttribute("action","#"),this.emailElement.setAttribute("type","email"),this.emailElement.setAttribute("name","email"),this.emailElement.setAttribute("placeholder","email"),this.emailElement.setAttribute("Required","true"),this.passwordElement.setAttribute("type","password"),this.passwordElement.setAttribute("name","password"),this.passwordElement.setAttribute("placeholder","password"),this.passwordElement.setAttribute("Required","true"),this.emailElement.addEventListener("input",(()=>this.validateEmail())),this.passwordElement.addEventListener("input",(()=>this.validatePassword())),l.getElement().addEventListener("click",(t=>this.showPassword(t))),o.getElement().addEventListener("click",(t=>this.submitLogin(t))),h.getElement().addEventListener("click",(()=>{this.router.navigate(m._.REGISTRATION)})),s.addInnerElement(t),s.addInnerElement(e),s.addInnerElement(this.loginEmail),i.addInnerElement(this.loginPassword),i.addInnerElement(l),s.addInnerElement(i),s.addInnerElement(o),d.addInnerElement(E),d.addInnerElement(h),this.getCreator().addInnerElement(s),this.getCreator().addInnerElement(d)}showPassword(t){t.preventDefault(),"password"===this.passwordElement.getAttribute("type")?this.passwordElement.setAttribute("type","text"):this.passwordElement.setAttribute("type","password")}async submitLogin(t){t.preventDefault();const e=this.emailElement.value,s=this.passwordElement.value;if(e||(this.emailElement.setCustomValidity(N.FILL_EMAIL),this.emailElement.reportValidity()),s||(this.passwordElement.setCustomValidity(N.FILL_PASSWORD),this.passwordElement.reportValidity()),0!==e.length&&0!==s.length&&this.validatePassword()&&this.validateEmail()){if(void 0!==e)try{if(0===(await this.anonimApi.checkCustomerExist(e)).body.results.length)return this.emailElement.setCustomValidity(N.MAIL_NOT_REGISTERED),void this.emailElement.reportValidity()}catch(t){t instanceof Error&&console.log(t.message)}this.anonimApi.getCustomer({email:e,password:s}).then((t=>{t.body.customer&&(window.localStorage.setItem("isLogin","true"),window.localStorage.setItem(E.Z.MAIL_ADDRESS,e),this.observer.notify(d.Z.LOGIN),this.router.navigate(m._.INDEX),this.userApi=new i.Z({email:e,password:s}),this.userApi.returnCustomerById(t.body.customer.id))})).catch((()=>{this.passwordElement.setCustomValidity(N.PASSWORD_IS_WRONG),this.passwordElement.reportValidity()}))}}validateEmail(){const{value:t}=this.emailElement;switch(this.emailElement.setCustomValidity(""),!0){case!p.test(t):case t.indexOf(" ")>-1:this.emailElement.setCustomValidity(N.EMAIL_CONTAIN_WHITESPACE);break;case!I.test(t):this.emailElement.setCustomValidity(N.EMAIL_WRONG_FORMAT);break;default:return this.emailElement.setCustomValidity(""),!0}return this.emailElement.reportValidity(),!1}validatePassword(){const{value:t}=this.passwordElement;switch(this.passwordElement.setCustomValidity(""),!0){case!p.test(t):this.passwordElement.setCustomValidity(N.PASSWORD_CONTAIN_WHITESPACE);break;case!h.test(t):this.passwordElement.setCustomValidity(N.PASSWORD_NOT_CONTAIN_DIGIT);break;case!c.test(t):this.passwordElement.setCustomValidity(N.PASSWORD_NOT_CONTAIN_LOWER_LETTER);break;case!u.test(t):this.passwordElement.setCustomValidity(N.PASSWORD_NOT_CONTAIN_UPPER_LETTER);break;case!w.test(t):this.passwordElement.setCustomValidity(N.PASSWORD_NOT_CONTAIN_SIMBOLS);break;case!g.test(t):this.passwordElement.setCustomValidity(N.PASSWORD_LENGTH_NOT_ENOUTH);break;default:return this.passwordElement.setCustomValidity(""),!0}return this.passwordElement.reportValidity(),!1}}},953:(t,e,s)=>{var i;s.d(e,{Z:()=>a}),function(t){t.MAIL_ADDRESS="mailAddress"}(i||(i={}));const a=i}}]);