"use strict";(self.webpackChunkecommerce_application=self.webpackChunkecommerce_application||[]).push([[639],{377:(e,t,s)=>{s.r(t),s.d(t,{default:()=>J});const i={wrap:"wrap--DHYWB"};var n,a=s(1567),r=s(6249),o=s(4602),l=s(891),d=s(213),h=s(928),u=s(4121);!function(e){e.ADD_SHIPPING_ADDRESS_BUTTON="add shipping address",e.ADD_BILLING_ADDRESS_BUTTON="add billing address",e.DELETE_ADDRESS_BUTTON="delete this address",e.MAKE_ADDRESS_SHIPPING_BUTTON="make this address shipping",e.MAKE_ADDRESS_BILLING_BUTTON="make this address billing",e.MAKE_ADDRESS_SHIPPING_DEFAULT_BUTTON="make this address default shipping",e.MAKE_ADDRESS_BILLING_DEFAULT_BUTTON="make this address default billing",e.TITLE_ADDRESS_SHIPPING="shipping address",e.TITLE_ADDRESS_BILLING="billing address",e.DEFAULT_ADDRESS_SHIIPPING="default shipping",e.DEFAULT_ADDRESS_BILLING="default billling",e.REDACTION_MODE_BUTTON="edit",e.CONFIRM_BUTTON="confirm",e.CANCEL_BUTTON="cancel",e.CONFIRM_MESSAGE_INFO="new data successfully saved",e.CANCEL_MESSAGE_INFO="modifications have been canceled",e.CHANGE_COUNTRY_INFO="Don't forget to change the postal code according to the selected country",e.COUNTRY_CHANGING_OK="data successfully changed",e.CHANGE_PASSWORD="change password",e.CHANGE_PASSWORD_INFO_IS_OK="password successfully changed",e.ADD_ADRESS_OK="the address was successfully added",e.CHANGE_ADRESS_OK="the address was successfully changed",e.VALIDATE_INPUT_BEFORE_SUBMIT="Make sure you fill out your account correctly",e.VALIDATE_FORM_BEFORE_SUBMIT="Make sure you fill out all fields correctly",e.NEW_PASSWORD_FIELD_LABEL="enter the new password",e.REPEAT_NEW_PASSWORD_FIELD_LABEL="repeat the new password",e.OLD_PASSWORD_FIELD_LABEL="enter the existing password"}(n||(n={}));const c=n;var g=s(4296),E=s(7881),m=s(2953),p=s(5246),C=s(4957);const A={"field-group":"field-group--magme"},D={"field-view":"field-view--kJ8a8"},I={active:"active--GNwPO"},w={"redaction-button":"redaction-button--gfaO6"};var S=s(5311),_=s(22),B=s(8624),N=s(8687);class f extends N.Z{constructor(){super(N.C.Info)}}const T={button:"button--p_MbL"};class L{constructor(e,t,s,i){this.textContent=e,this.classList=t,this.eventListener=s,this.event=i,this.button=this.createButton()}getButton(){return this.button}createButton(){const e=document.createElement(a.Z.BUTTON);return e.textContent=this.textContent,e.classList.add(...Object.values(T)),this.classList&&e.classList.add(...this.classList),this.eventListener&&this.event&&e.addEventListener(this.event,this.eventListener),e}}var O,F=s(5476);!function(e){e.EMAIL_ADDRESS="email",e.FIRST_NAME="firstName",e.LAST_NAME="lastName",e.DATE_OF_BIRTH="dateOfBirth"}(O||(O={}));const y=O;var M=s(4218),b=s(8717);class v{constructor(e){this.elementField=this.createElementField(),this.inputElement=new F.Z(e.inputParams),this.value=e.value,this.labelValue=e.inputParams.attributes.placeholder,this.action=e.action,this.actionName=e.actionName,this.id=e.id,this.cancelButton=this.createCancelButton(),this.confirmButton=this.createConfirmButton(),this.redactionModeButton=this.createRedactionModeButton(),this.configureView()}getElement(){return this.elementField}getInputElement(){return this.inputElement}getConfirmButton(){return this.confirmButton}createElementField(){const e=document.createElement(a.Z.DIV);return e.classList.add(...Object.values(D)),e}configureView(){this.configureInputElement(),this.elementField.append(this.inputElement.getElement(),this.redactionModeButton)}configureInputElement(){this.inputElement.setDisabled(),this.inputElement.setInputValue(this.value),this.inputElement.setLabel(this.labelValue),this.inputElement.removeMessageElement()}createRedactionModeButton(){return this.createButton(c.REDACTION_MODE_BUTTON,Object.values(w),this.redactionModeHandler.bind(this),S.Z.CLICK)}createConfirmButton(){return this.createButton(c.CONFIRM_BUTTON,Object.values(w),this.saveValueHandler.bind(this),S.Z.CLICK)}createCancelButton(){return this.createButton(c.CANCEL_BUTTON,Object.values(w),this.cancelValueHandler.bind(this),S.Z.CLICK)}createButton(e,t,s,i){return new L(e,t,s,i).getButton()}showInfoMessage(e){(new f).showMessage(e)}showErrorMessage(e){(new B.Z).showMessage(e)}showWarningMessage(e){(new _.Z).showMessage(e)}redactionModeHandler(){this.value=this.inputElement.getInputValue(),this.inputElement.appendMessage(),this.elementField.removeChild(this.redactionModeButton),this.inputElement.removeDisabled(),this.elementField.append(this.confirmButton,this.cancelButton),this.elementField.classList.add(...Object.values(I))}saveValueHandler(){[b.I$.EMAIL,b.I$.FIRST_NAME,b.I$.LAST_NAME,`${b.I$.DATE_OF_BIRTH}. ${b.WA.DATE_OF_BIRTH_HINT}`].includes(this.labelValue)&&(this.value=this.inputElement.getInputValue(),this.inputElement.getInput().checkValidity()?(this.exitEditModeChangeButton(),this.saveValue()):this.showWarningMessage(c.VALIDATE_INPUT_BEFORE_SUBMIT))}cancelValueHandler(){this.exitEditModeChangeButton(),this.inputElement.setInputValue(this.value),this.showInfoMessage(c.CANCEL_MESSAGE_INFO)}exitEditModeChangeButton(){this.inputElement.setDisabled(),this.elementField.removeChild(this.confirmButton),this.elementField.removeChild(this.cancelButton),this.inputElement.removeMessageElementFromLabel(),this.elementField.append(this.redactionModeButton),this.elementField.classList.remove(...Object.values(I))}saveValue(){const e=new u.Z;e.getCustomer(window.localStorage.getItem(m.Z.MAIL_ADDRESS)).then((t=>{e.changeData(this.id,t.body.results[0].version,this.action,this.actionName,this.value).then((e=>{this.actionName===y.EMAIL_ADDRESS&&window.localStorage.setItem(m.Z.MAIL_ADDRESS,this.value),e.statusCode===M.Z.USER_VALUE_CHANGED&&this.showInfoMessage(c.CONFIRM_MESSAGE_INFO)})).catch((e=>{this.showErrorMessage(e.message)}))})).catch((e=>{this.showErrorMessage(e.message)}))}}class P{constructor(e){this.mainFieldGroup=this.createMainFieldGroupElement(),this.userFieldsProps=e,this.userFieldElements=this.createUserFieldsElements(),this.configureView()}getElement(){return this.mainFieldGroup}configureView(){this.mainFieldGroup.append(...this.userFieldElements)}createMainFieldGroupElement(){const e=document.createElement(a.Z.DIV);return e.classList.add(...Object.values(A)),e}createUserFieldsElements(){const e=[];return this.userFieldsProps.forEach((t=>{const s=new v(t);e.push(s.getElement())})),e}}const R={"button-wrap":"button-wrap--IOykP"},H={description:"description--hPbg6"};var Z;!function(e){e[e.ID=0]="ID",e[e.STREET=1]="STREET",e[e.POSTAL=2]="POSTAL",e[e.CITY=3]="CITY",e[e.COUNTRY=4]="COUNTRY"}(Z||(Z={}));const V=Z;var U,G=s(423),k=s(2123);class W{constructor(e){this.deleteAddressButton=this.createDeleteButton(),this.makeShippingDefaultButton=this.createMakeDefaultShippingButton(),this.makeBillingDefaultButton=this.createMakeDefaultBillingButton(),this.makeShippingButton=this.createMakeShippingButton(),this.makeBillingButton=this.createMakeBillingButton(),this.observer=g.Z.getInstance(),this.addressGroup=this.createAddressFieldGroupElement(),this.countryOptions=new p.Z,this.inputsParams=new C.Z,this.values=this.createValues(e),this.streetField=this.createStreetField(),this.cityField=this.createCityField(),this.postalField=this.createPostalField(),this.countryField=this.createCountryField(),this.confirmButtons=this.createConfirmButtons(),this.configureConfirmButtons(),this.fields=[this.streetField,this.cityField,this.postalField,this.countryField],this.countryField.getElement().addEventListener(S.Z.CHANGE,this.validateCountryListHandler.bind(this)),this.countryField.getElement().addEventListener("change",this.changeCountryHandler.bind(this)),this.buttonWrap=this.configureButtons(e),this.configureView(e)}getElement(){return this.addressGroup}configureView(e){this.addressGroup.append(this.createDescription(e),this.streetField.getElement(),this.cityField.getElement(),this.postalField.getElement(),this.countryField.getElement(),this.buttonWrap,this.countryOptions.getListElement())}createConfirmButtons(){return[this.streetField.getConfirmButton(),this.cityField.getConfirmButton(),this.postalField.getConfirmButton(),this.countryField.getConfirmButton()]}configureConfirmButtons(){this.confirmButtons.forEach((e=>e.addEventListener(S.Z.CLICK,this.confirmHandler.bind(this))))}createValues(e){return[e.id,e.streetName,e.postalCode,e.city,e.country]}createAddressFieldGroupElement(){const e=document.createElement(a.Z.DIV);return e.classList.add(...Object.values(A)),e}createStreetField(){const e=this.values[V.STREET],t={id:this.values[V.ID],action:"",actionName:"",value:e,inputParams:this.inputsParams.getStreetParams()};return new v(t)}createCityField(){const e=this.values[V.CITY],t={id:this.values[V.ID],action:"",actionName:"",value:e,inputParams:this.inputsParams.getCityParams()};return new v(t)}createPostalField(){const e=this.values[V.POSTAL],t={id:this.values[V.ID],action:"",actionName:"",value:e,inputParams:this.inputsParams.getSPostalParams()};return new v(t)}createCountryField(){const e=this.countryOptions.getCountryByCode(this.values[V.COUNTRY]),t={id:this.values[V.ID],action:"",actionName:"",value:e,inputParams:this.inputsParams.getCountryParams()};return new v(t)}createDescription(e){const t=document.createElement(a.Z.DIV);return t.classList.add(...Object.values(H)),e.isShining&&t.append(this.createTitle(c.TITLE_ADDRESS_SHIPPING)),e.isBilling&&t.append(this.createTitle(c.TITLE_ADDRESS_BILLING)),e.isDefaultShipping&&t.append(this.createTitle(c.DEFAULT_ADDRESS_SHIIPPING)),e.isDefaultBilling&&t.append(this.createTitle(c.DEFAULT_ADDRESS_BILLING)),t}createTitle(e){const t=document.createElement("h3");return t.textContent=e,t}changeCountryHandler(){this.showInfoMessage(c.CHANGE_COUNTRY_INFO)}validateCountryListHandler(){const e=this.countryOptions.getCountryList(),t=this.countryField.getInputElement(),s=this.postalField.getInputElement(),i=t.getInputValue();e.flat().includes(i)?(this.changePostalPatternWithCountry(s,e,i),t.setCustomValidity("")):(t.setCustomValidity(b.WA.COUNTRY_HINT),this.changePostalPatternWithOutCountry(s))}changePostalPatternWithCountry(e,t,s){t.forEach(((t,i)=>{if(t.includes(s)){const t=Array.from(Object.values(G.Z))[i];e.setPattern(t);const n=Array.from(Object.values(k.Z))[i],a=`${s.slice(0,-3)}\`s postal ${n}`;e.setTitle(a),e.setMessageError(a),e.setCustomValidity("")}}))}changePostalPatternWithOutCountry(e){e.setTitle(b.WA.WRONG_COUNTRY),e.setMessageError(b.WA.WRONG_COUNTRY),e.setCustomValidity(b.WA.WRONG_COUNTRY)}showInfoMessage(e){(new f).showMessage(e)}confirmHandler(){if(this.isCheckValidityForm())this.showWarningMessage(c.VALIDATE_FORM_BEFORE_SUBMIT);else{const e=new u.Z;e.getCustomer(window.localStorage.getItem(m.Z.MAIL_ADDRESS)).then((t=>{e.changeAddress(t.body.results[0].id,t.body.results[0].version,this.values[V.ID],this.streetField.getInputElement().getInputValue(),this.postalField.getInputElement().getInputValue(),this.cityField.getInputElement().getInputValue(),this.countryField.getInputElement().getInputValue().slice(-2)).catch((e=>{this.showErrorMessage(e.message)}))})).then((()=>{this.fields.forEach((e=>{e.getElement().classList.contains(I.active)&&(e.exitEditModeChangeButton(),this.showInfoMessage(c.COUNTRY_CHANGING_OK))}))})).catch((e=>{"The anonymousId is already in use."===e.message?this.confirmHandler():this.showErrorMessage(e.message)}))}}showErrorMessage(e){(new B.Z).showMessage(e)}showWarningMessage(e){(new _.Z).showMessage(e)}isCheckValidityForm(){let e=!0;return this.streetField.getInputElement().getInput().checkValidity()&&this.postalField.getInputElement().getInput().checkValidity()&&this.cityField.getInputElement().getInput().checkValidity()&&this.countryField.getInputElement().getInput().checkValidity()&&(e=!1),e}createMakeDefaultShippingButton(){return this.createButtons(c.MAKE_ADDRESS_SHIPPING_DEFAULT_BUTTON,this.makeDefaulShippingtHandler.bind(this),S.Z.CLICK)}makeDefaulShippingtHandler(){const e=new u.Z;e.getCustomer(window.localStorage.getItem(m.Z.MAIL_ADDRESS)).then((t=>{e.makeAddressShippingDefault(t.body.results[0].id,t.body.results[0].version,this.values[V.ID]).then((e=>{e.statusCode===M.Z.USER_VALUE_CHANGED&&this.observer.notify(E.Z.ADDRESS_CHANGED)})).catch((e=>{this.showErrorMessage(e)}))})).catch((e=>{"The anonymousId is already in use."===e.message?this.makeDefaulShippingtHandler():this.showErrorMessage(e.message)}))}createMakeDefaultBillingButton(){return this.createButtons(c.MAKE_ADDRESS_BILLING_DEFAULT_BUTTON,this.makeDefaultBillingHandler.bind(this),S.Z.CLICK)}makeDefaultBillingHandler(){const e=new u.Z;e.getCustomer(window.localStorage.getItem(m.Z.MAIL_ADDRESS)).then((t=>{e.makeAddressBillingDefault(t.body.results[0].id,t.body.results[0].version,this.values[V.ID]).then((e=>{e.statusCode===M.Z.USER_VALUE_CHANGED&&this.observer.notify(E.Z.ADDRESS_CHANGED)})).catch((e=>{this.showErrorMessage(e)}))})).catch((e=>{this.showErrorMessage(e)}))}createDeleteButton(){return this.createButtons(c.DELETE_ADDRESS_BUTTON,this.deleteAdressButtonHAndler.bind(this),S.Z.CLICK)}deleteAdressButtonHAndler(){const e=new u.Z;e.getCustomer(window.localStorage.getItem(m.Z.MAIL_ADDRESS)).then((t=>{e.deleteAdress(t.body.results[0].id,t.body.results[0].version,this.values[V.ID]).then((e=>{e.statusCode===M.Z.USER_VALUE_CHANGED&&this.observer.notify(E.Z.ADDRESS_CHANGED)})).catch((e=>{this.showErrorMessage(e)}))})).catch((e=>{"The anonymousId is already in use."===e.message?this.deleteAdressButtonHAndler():this.showErrorMessage(e.message)}))}createMakeShippingButton(){return this.createButtons(c.MAKE_ADDRESS_SHIPPING_BUTTON,this.makeShippingtHandler.bind(this),S.Z.CLICK)}makeShippingtHandler(){const e=new u.Z;e.getCustomer(window.localStorage.getItem(m.Z.MAIL_ADDRESS)).then((t=>{e.makeAddressShipping(t.body.results[0].id,t.body.results[0].version,this.values[V.ID]).then((e=>{e.statusCode===M.Z.USER_VALUE_CHANGED&&this.observer.notify(E.Z.ADDRESS_CHANGED)})).catch((e=>{this.showErrorMessage(e)}))})).catch((e=>{this.showErrorMessage(e)}))}createMakeBillingButton(){return this.createButtons(c.MAKE_ADDRESS_BILLING_BUTTON,this.makeBillingHandler.bind(this),S.Z.CLICK)}makeBillingHandler(){const e=new u.Z;e.getCustomer(window.localStorage.getItem(m.Z.MAIL_ADDRESS)).then((t=>{e.makeAddressBilling(t.body.results[0].id,t.body.results[0].version,this.values[V.ID]).then((e=>{e.statusCode===M.Z.USER_VALUE_CHANGED&&this.observer.notify(E.Z.ADDRESS_CHANGED)})).catch((e=>{this.showErrorMessage(e)}))})).catch((e=>{"The anonymousId is already in use."===e.message?this.makeBillingHandler():this.showErrorMessage(e.message)}))}createButtons(e,t,s){return new L(e,Object.values(w),t,s).getButton()}configureButtons(e){const t=document.createElement(a.Z.DIV);return t.classList.add(...Object.values(R)),t.append(this.deleteAddressButton,this.makeShippingButton,this.makeBillingButton,this.makeShippingDefaultButton,this.makeBillingDefaultButton),e.isShining&&t.removeChild(this.makeShippingButton),e.isBilling&&t.removeChild(this.makeBillingButton),e.isDefaultShipping&&t.removeChild(this.makeShippingDefaultButton),e.isDefaultBilling&&t.removeChild(this.makeBillingDefaultButton),t}}!function(e){e.CHANGE_EMAIL_ADDRESS="changeEmail",e.CHANGE_FIRST_NAME="setFirstName",e.CHANGE_LAST_NAME="setLastName",e.CHANGE_DATE_OF_BIRTH="setDateOfBirth"}(U||(U={}));const K=U,j={"password-changer":"password-changer--dPVTA"},Y={"password-field":"password-field--fp0Qg"},x={"password-wrap":"password-wrap--tJPSS"};class ${constructor(e){this.parentElement=e,this.passwordChangerElement=this.createPasswordChangerElement(),this.inputParamsCreator=new C.Z,this.newPasswordField=this.createPasswordField(this.inputParamsCreator.getPasswordParams(),c.NEW_PASSWORD_FIELD_LABEL),this.repeatPasswordField=this.createPasswordField(this.inputParamsCreator.getPasswordRepeatParams(),c.REPEAT_NEW_PASSWORD_FIELD_LABEL),this.confirmOldPasswordField=this.createPasswordField(this.inputParamsCreator.getPasswordParams(),c.OLD_PASSWORD_FIELD_LABEL),this.buttonCancel=this.createButtonCancel(),this.buttonConfirm=this.createButtonConfirm(),this.configureView()}configureView(){this.repeatPasswordField.getInput().addEventListener(S.Z.CHANGE,this.passwordCheckHandler.bind(this)),this.newPasswordField.getInput().addEventListener(S.Z.CHANGE,this.passwordCheckHandler.bind(this)),this.passwordChangerElement.addEventListener(S.Z.CLICK,this.goOutFromRedactionHandler.bind(this));const e=this.createWrap();e.append(this.newPasswordField.getElement(),this.repeatPasswordField.getElement(),this.confirmOldPasswordField.getElement(),this.buttonConfirm,this.buttonCancel),this.passwordChangerElement.append(e)}createWrap(){const e=document.createElement(a.Z.DIV);return e.classList.add(...Object.values(x)),e}getPasswordChanger(){return this.passwordChangerElement}createPasswordChangerElement(){const e=document.createElement(a.Z.DIV);return e.classList.add(...Object.values(j)),e}createPasswordField(e,t){const s=e,i=new F.Z(s);i.getElement().classList.add(...Object.values(Y));const n=this.createSubTitle(t);return i.getElement().prepend(n),i}createSubTitle(e){const t=document.createElement("h3");return t.classList.add(...Object.values(Y)),t.textContent=e,t}passwordCheckHandler(){const e=this.repeatPasswordField;this.newPasswordField.getInputValue()===e.getInputValue()?(e.setCustomValidity(""),e.removeMessage()):(e.setMessageError(b.WA.PASSWORD_REPEAT),e.setCustomValidity(b.WA.PASSWORD_REPEAT))}createButtonConfirm(){return this.createButtons(c.CONFIRM_BUTTON,this.confirmHandler.bind(this),S.Z.CLICK)}createButtonCancel(){return this.createButtons(c.CANCEL_BUTTON,this.cancelHandler.bind(this),S.Z.CLICK)}createButtons(e,t,s){return new L(e,void 0,t,s).getButton()}cancelHandler(){this.parentElement.removeChild(this.passwordChangerElement)}confirmHandler(){this.isCheckValidityForm()?this.showWarningMessage(c.VALIDATE_FORM_BEFORE_SUBMIT):this.changePassword()}showWarningMessage(e){(new _.Z).showMessage(e)}showInfoMessage(e){(new f).showMessage(e)}showErrorMessage(e){(new B.Z).showMessage(e)}goOutFromRedactionHandler(e){e.target===this.passwordChangerElement&&this.cancelHandler()}changePassword(){const e=new u.Z;e.getCustomer(window.localStorage.getItem(m.Z.MAIL_ADDRESS)).then((t=>{e.changePassword(t.body.results[0].id,this.newPasswordField.getInputValue(),this.confirmOldPasswordField.getInputValue(),t.body.results[0].version).then((e=>{e.statusCode===M.Z.USER_VALUE_CHANGED&&(this.showInfoMessage(c.CHANGE_PASSWORD_INFO_IS_OK),this.cancelHandler())})).catch((e=>{this.showErrorMessage(e.message)}))})).catch((e=>{this.showErrorMessage(e.message)}))}isCheckValidityForm(){let e=!0;return this.newPasswordField.getInput().checkValidity()&&this.confirmOldPasswordField.getInput().checkValidity()&&this.repeatPasswordField.getInput().checkValidity()&&(e=!1),e}}var q=s(6193);class X{constructor(e,t){this.isShiping=t,this.isDefault=!1,this.countryOptions=new p.Z,this.parentElement=e,this.adressChangerElement=this.createAddressGroupElement(),this.inputParamsCreator=new C.Z,this.observer=g.Z.getInstance(),this.streetField=this.createField(this.inputParamsCreator.getStreetParams(),b.I$.STREET),this.cityField=this.createField(this.inputParamsCreator.getCityParams(),b.I$.CITY),this.postalField=this.createField(this.inputParamsCreator.getSPostalParams(),b.I$.POSTAL),this.countryField=this.createField(this.inputParamsCreator.getCountryParams(),b.I$.COUNTRY),this.buttonCancel=this.createButtonCancel(),this.buttonConfirm=this.createButtonConfirm(),this.buttonDefault=this.createButtonDefault(),this.configureView()}configureView(){this.countryField.getInput().addEventListener(S.Z.CHANGE,this.validateCountryListHandler.bind(this)),this.adressChangerElement.addEventListener(S.Z.CLICK,this.goOutFromRedactionHandler.bind(this));const e=this.createWrap();e.append(this.buttonDefault,this.streetField.getElement(),this.cityField.getElement(),this.postalField.getElement(),this.countryField.getElement(),this.countryOptions.getListElement(),this.buttonConfirm,this.buttonCancel),this.adressChangerElement.append(e)}createWrap(){const e=document.createElement(a.Z.DIV);return e.classList.add(...Object.values(x)),e}getElement(){return this.adressChangerElement}createAddressGroupElement(){const e=document.createElement(a.Z.DIV);return e.classList.add(...Object.values(j)),e}createField(e,t){const s=e,i=new F.Z(s);i.getElement().classList.add(...Object.values(Y));const n=this.createSubTitle(t);return i.getElement().prepend(n),i}createSubTitle(e){const t=document.createElement("h3");return t.classList.add(...Object.values(Y)),t.textContent=e,t}validateCountryListHandler(){const e=this.countryOptions.getCountryList(),t=this.countryField,s=this.postalField,i=t.getInputValue();e.flat().includes(i)?(this.changePostalPatternWithCountry(s,e,i),t.setCustomValidity("")):(t.setCustomValidity(b.WA.COUNTRY_HINT),this.changePostalPatternWithOutCountry(s))}changePostalPatternWithCountry(e,t,s){t.forEach(((t,i)=>{if(t.includes(s)){const t=Array.from(Object.values(G.Z))[i];e.setPattern(t);const n=Array.from(Object.values(k.Z))[i],a=`${s.slice(0,-3)}\`s postal ${n}`;e.setTitle(a),e.setMessageError(a),e.setCustomValidity("")}}))}changePostalPatternWithOutCountry(e){e.setTitle(b.WA.WRONG_COUNTRY),e.setMessageError(b.WA.WRONG_COUNTRY),e.setCustomValidity(b.WA.WRONG_COUNTRY)}createButtonConfirm(){return this.createButtons(c.CONFIRM_BUTTON,this.confirmHandler.bind(this),S.Z.CLICK)}createButtonCancel(){return this.createButtons(c.CANCEL_BUTTON,this.cancelHandler.bind(this),S.Z.CLICK)}createButtonDefault(){return this.createButtons(q.Z.BUTTON_DEFAULT,this.defaultHandler.bind(this),S.Z.CLICK)}createButtons(e,t,s){return new L(e,void 0,t,s).getButton()}cancelHandler(){this.parentElement.removeChild(this.adressChangerElement)}confirmHandler(){this.isCheckValidityForm()?this.showWarningMessage(c.VALIDATE_FORM_BEFORE_SUBMIT):this.changeAdress()}defaultHandler(){this.isDefault?(this.isDefault=!1,this.buttonDefault.textContent=q.Z.BUTTON_DEFAULT):(this.isDefault=!0,this.buttonDefault.textContent=q.Z.BUTTON_UN_DEFAULT)}showWarningMessage(e){(new _.Z).showMessage(e)}showInfoMessage(e){(new f).showMessage(e)}showErrorMessage(e){(new B.Z).showMessage(e)}goOutFromRedactionHandler(e){e.target===this.adressChangerElement&&this.cancelHandler()}changeAdress(){const e=new u.Z;e.getCustomer(window.localStorage.getItem(m.Z.MAIL_ADDRESS)).then((t=>{e.addAddress(t.body.results[0].id,t.body.results[0].version,this.streetField.getInputValue(),this.postalField.getInputValue(),this.cityField.getInputValue(),this.countryField.getInputValue().slice(-2)).then((e=>{if(e.statusCode===M.Z.USER_VALUE_CHANGED)return{id:e.body.addresses[e.body.addresses.length-1].id,version:e.body.version,statusCode:e.statusCode}})).then((s=>(void 0!==s&&(this.isShiping?e.makeAddressShipping(t.body.results[0].id,s.version,s.id).then((t=>{this.isDefault&&e.makeAddressShippingDefault(t.body.id,t.body.version,t.body.addresses[t.body.addresses.length-1].id).catch((e=>{this.showErrorMessage(e)}))})).catch((e=>{this.showErrorMessage(e)})):e.makeAddressBilling(t.body.results[0].id,s.version,s.id).then((t=>{this.isDefault&&e.makeAddressBillingDefault(t.body.id,t.body.version,t.body.addresses[t.body.addresses.length-1].id).catch((e=>{this.showErrorMessage(e)}))})).catch((e=>{this.showErrorMessage(e)}))),s))).then((e=>{e.statusCode===M.Z.USER_VALUE_CHANGED&&this.observer.notify(E.Z.ADDRESS_ADDED)})).catch((e=>{this.showErrorMessage(e.message)}))})).catch((e=>{"The anonymousId is already in use."===e.message?this.changeAdress():this.showErrorMessage(e.message)}))}isCheckValidityForm(){let e=!0;return this.streetField.getInput().checkValidity()&&this.postalField.getInput().checkValidity()&&this.cityField.getInput().checkValidity()&&this.countryField.getInput().checkValidity()&&(e=!1),e}}class J extends h.Z{constructor(e){super({tag:a.Z.SECTION,classNames:["profile-view--tXFs_"],textContent:""}),this.router=e,this.emailAddress=window.localStorage.getItem(m.Z.MAIL_ADDRESS),this.observer=g.Z.getInstance(),this.countryOptions=new p.Z,this.wrapper=(new r.Z).createTagElement("div",Object.values(i)),this.getCreator().addInnerElement(this.wrapper),this.userData=this.request(),this.configView(),this.observer.subscribe(E.Z.LOGIN,this.login.bind(this)),this.observer.subscribe(E.Z.LOGOUT,this.logoutListener.bind(this)),this.observer.subscribe(E.Z.ADDRESS_CHANGED,this.addressChangedHandler.bind(this)),this.observer.subscribe(E.Z.ADDRESS_ADDED,this.addressAddHandler.bind(this))}setContent(e){this.wrapper.replaceChildren(""),e instanceof o.Z?this.wrapper.append(e.getElement()):this.wrapper.append(e)}configView(){this.createContent()}addressChangedHandler(){this.userData=this.request(),this.showInfoMessage(c.CHANGE_ADRESS_OK)}addressAddHandler(){this.userData=this.request(),this.showInfoMessage(c.ADD_ADRESS_OK)}login(){this.emailAddress=window.localStorage.getItem(m.Z.MAIL_ADDRESS),this.userData=this.request()}logoutListener(){this.wrapper.textContent="";const e=this.createMainButton();this.wrapper.append(e.getElement())}createContent(){this.wrapper.textContent="";const e=this.createMainButton();e.getElement().classList.add(...Object.values(w));const t=this.createButton(c.CHANGE_PASSWORD,this.goToPasswordChangerHandler.bind(this),S.Z.CLICK),s=new L(c.ADD_SHIPPING_ADDRESS_BUTTON,Object.values(w),this.addShippingAddressHandler.bind(this),S.Z.CLICK),n=new L(c.ADD_BILLING_ADDRESS_BUTTON,Object.values(w),this.addBillingAddressHandler.bind(this),S.Z.CLICK);this.wrapper.append(e.getElement(),t,s.getButton(),n.getButton());const a=this.createUserField(),o=(new r.Z).createTagElement("div",Object.values(i)),l=this.createAddressGroup(this.userData.addresses);o.append(a,...l),this.wrapper.append(o)}createMainButton(){return new d.Z(l.bm.INDEX,(()=>{this.router.navigate(l._.INDEX)}))}request(){const e=new u.Z,t=this.createUserData(),s=this.emailAddress;return s&&e.getCustomer(s).then((e=>{const s=e.body.results[0];return null!=s.id&&(t.id=s.id),null!=s.version&&(t.version=s.version),null!=s.firstName&&(t.firstName=s.firstName),null!=s.lastName&&(t.lastName=s.lastName),null!=s.dateOfBirth&&(t.dateOfBirth=s.dateOfBirth),t.addresses=this.createAddresses(s.addresses,s.shippingAddressIds,s.billingAddressIds,s.defaultShippingAddressId,s.defaultBillingAddressId),t})).then((()=>this.configView())).catch((e=>{"The anonymousId is already in use."===e.message?this.userData=this.request():this.showErrorMessage(e.message)})),t}createAddressGroup(e){const t=[];return e.forEach((e=>{const s=new W(e);t.push(s.getElement())})),t}createAddresses(e,t,s,i,n){const a=[];return e.forEach((e=>{void 0!==e.id&&(void 0!==t&&t.includes(e.id)&&(e.isShining=!0),void 0!==s&&s.includes(e.id)&&(e.isBilling=!0),void 0!==i&&i===e.id&&(e.isDefaultShipping=!0),void 0!==n&&n===e.id&&(e.isDefaultBilling=!0)),a.push(e)})),a}createMainProps(){const e=new C.Z;return[{id:this.userData.id,action:K.CHANGE_EMAIL_ADDRESS,actionName:y.EMAIL_ADDRESS,value:this.emailAddress,inputParams:e.getMailParams()},{id:this.userData.id,action:K.CHANGE_FIRST_NAME,actionName:y.FIRST_NAME,value:this.userData.firstName,inputParams:e.getFirstNameParams()},{id:this.userData.id,action:K.CHANGE_LAST_NAME,value:this.userData.lastName,actionName:y.LAST_NAME,inputParams:e.getLastNameParams()},{id:this.userData.id,action:K.CHANGE_DATE_OF_BIRTH,value:this.userData.dateOfBirth,actionName:y.DATE_OF_BIRTH,inputParams:e.getDateParams()}]}createButton(e,t,s){return new L(e,Object.values(w),t,s).getButton()}createUserData(){const e="unassigned";return{id:e,version:0,firstName:e,lastName:e,dateOfBirth:e,shippingAddresses:[{city:e,country:e,id:e,postalCode:e,streetName:e,isDefaultShipping:!1,isDefaultBilling:!1,isShining:!1,isBilling:!1}],billingAddresses:[{city:e,country:e,id:e,postalCode:e,streetName:e,isDefaultShipping:!1,isDefaultBilling:!1,isShining:!1,isBilling:!1}],addresses:[{city:e,country:e,id:e,postalCode:e,streetName:e,isDefaultShipping:!1,isDefaultBilling:!1,isShining:!1,isBilling:!1}]}}createUserField(){const e=this.createMainProps();return new P(e).getElement()}goToPasswordChangerHandler(){const e=new $(this.wrapper);this.wrapper.append(e.getPasswordChanger())}addShippingAddressHandler(){const e=new X(this.wrapper,!0);this.wrapper.append(e.getElement())}addBillingAddressHandler(){const e=new X(this.wrapper,!1);this.wrapper.append(e.getElement())}showInfoMessage(e){(new f).showMessage(e)}showErrorMessage(e){(new B.Z).showMessage(e)}}}}]);