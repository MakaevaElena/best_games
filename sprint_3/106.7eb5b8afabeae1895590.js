"use strict";(self.webpackChunkecommerce_application=self.webpackChunkecommerce_application||[]).push([[106],{429:(t,e,s)=>{s.d(e,{Z:()=>o});var i=s(37),a=s(683),r=s(233);class o{constructor(t){if(this.clientRoot=(0,i.mv)((0,a.p0)()).withProjectKey({projectKey:"best-games"}),this.createCart=t=>this.clientRoot.carts().post({body:{key:`cart-key-${Math.floor(1e5*Math.random())}`,currency:"RUB",country:"RU",customerId:t}}).execute(),t){const e=(0,r.r4)(t.email,t.password);this.clientRoot=(0,i.mv)(e).withProjectKey({projectKey:"best-games"})}}checkCustomerExist(t){return this.returnCustomerByEmail(t).then((t=>t))}returnCustomerByEmail(t){return this.clientRoot.customers().get({queryArgs:{where:`email="${t}"`}}).execute()}returnCustomerById(t){return this.clientRoot.customers().get({queryArgs:{where:`id="${t}"`}}).execute()}getCustomer({email:t,password:e}){return this.clientRoot.me().login().post({body:{email:t,password:e,updateProductData:!0}}).execute()}createUserRoot(t,e){const s=(0,r.r4)(t,e);return this.clientRoot=(0,i.mv)(s).withProjectKey({projectKey:"best-games"}),this.clientRoot}getCartByCustomerId(t){return this.clientRoot.carts().withCustomerId({customerId:t}).get().execute()}createCustomerDraft(t){const{email:e,password:s,firstName:i,lastName:a,countryCode:r,key:o}=t;return{email:e,password:s,key:o,firstName:i,lastName:a,addresses:[{country:r}],defaultShippingAddress:0}}createCustomer(t){try{return this.clientRoot.customers().post({body:this.createCustomerDraft(t)}).execute()}catch(t){return t}}getProducts(){return this.clientRoot.products().get().execute()}getProductbyID(t){return this.clientRoot.products().withId({ID:t}).get().execute()}getProductbyKey(t){return this.clientRoot.products().withKey({key:t}).get().execute()}productProjectionResponseID(t){return this.clientRoot.productProjections().withId({ID:t}).get({queryArgs:{staged:!0}}).execute()}productProjectionResponseKEY(t){return this.clientRoot.productProjections().withKey({key:t}).get({queryArgs:{staged:!0}}).execute()}}},683:(t,e,s)=>{s.d(e,{p0:()=>r});var i=s(631);const a="best-games",r=()=>{const t={host:"https://auth.europe-west1.gcp.commercetools.com",projectKey:a,credentials:{clientId:"A8PxwfHMEiItZ24oahyDGO2A",clientSecret:"RKi7doGwQ75b4wfuLsPuahDT366uOhUY",anonymousId:`best-games-${Math.floor(1e5*Math.random())}`},scopes:[`manage_project:${a}`]},e={host:"https://api.europe-west1.gcp.commercetools.com",fetch};return(new i.Qx).withAnonymousSessionFlow(t).withProjectKey(a).withHttpMiddleware(e).withLoggerMiddleware().build()}},233:(t,e,s)=>{s.d(e,{r4:()=>r});var i=s(631);const a="best-games",r=(t,e)=>{const s={host:"https://auth.europe-west1.gcp.commercetools.com",projectKey:a,credentials:{clientId:"A8PxwfHMEiItZ24oahyDGO2A",clientSecret:"RKi7doGwQ75b4wfuLsPuahDT366uOhUY",user:{username:t,password:e}},scopes:[`manage_project:${a}`],fetch},r={host:"https://api.europe-west1.gcp.commercetools.com",fetch};return(new i.Qx).withPasswordFlow(s).withProjectKey(a).withHttpMiddleware(r).withLoggerMiddleware().build()}},106:(t,e,s)=>{s.r(e),s.d(e,{default:()=>A});var i=s(429),a=s(567),r=s(602),o=s(928);const n={"login-view":"login-view--xYXHF","registration-field":"registration-field--rfaSb","login-title":"login-title--ZnrER","registration-field__title":"registration-field__title--IH0AX","login-subtitle":"login-subtitle--Bhb9b","login-form":"login-form--JFEMt","login-form__show-password":"login-form__show-password--r1rU6","password-block":"password-block--dqC0n",button:"button--KUb8s",field:"field--_0gSU",disabled:"disabled--LALv4"};var l=s(296),d=s(881),m=s(891);const c=/(?=.*[0-9])/g,u=/(?=.*[a-z])/,h=/(?=.*[A-Z])/,w=/(?=.*[!@#$%^&*])/,E=/[0-9a-zA-Z!@#$%^&*]{8,}/,p=/[^\s]/gim,g=/[a-z0-9]+[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}/;var I;!function(t){t.FILL_EMAIL="Please fill the field email.",t.FILL_PASSWORD="Please fill the field password.",t.MAIL_NOT_REGISTERED="This email address has not been registered.",t.SUCCESS_LOGIN="Welcome! You are logged!.",t.PASSWORD_IS_WRONG="Password is wrong!",t.EMAIL_CONTAIN_WHITESPACE="Email address must not contain leading or trailing whitespace.",t.EMAIL_WRONG_FORMAT="Email address must be properly formatted (e.g., user@example.com).",t.PASSWORD_CONTAIN_WHITESPACE="Password must not contain leading or trailing whitespace.",t.PASSWORD_NOT_CONTAIN_DIGIT="Password must contain at least one digit (0-9).",t.PASSWORD_NOT_CONTAIN_LOWER_LETTER="Password must contain at least one lowercase letter (a-z).",t.PASSWORD_NOT_CONTAIN_UPPER_LETTER="Password must contain at least one uppercase letter (A-Z).",t.PASSWORD_NOT_CONTAIN_SIMBOLS="Password must contain at least one special character (e.g., !@#$%^&*).",t.PASSWORD_LENGTH_NOT_ENOUTH="Password must be at least 8 characters long."}(I||(I={}));class A extends o.Z{constructor(t){super({tag:a.Z.SECTION,classNames:[n["login-view"]],textContent:""}),this.loginEmail=new r.Z({tag:a.Z.INPUT,classNames:[n.field],textContent:"email"}),this.loginPassword=new r.Z({tag:a.Z.INPUT,classNames:[n.field],textContent:"password"}),this.passwordElement=this.loginPassword.getElement(),this.emailElement=this.loginEmail.getElement(),this.router=t,this.observer=l.Z.getInstance(),this.observer?.subscribe(d.Z.LOGOUT,this.updateLoginPage.bind(this)),this.anonimApi=new i.Z,"true"===localStorage.getItem("isLogin")?this.router.navigate(m._.INDEX):this.configView()}configView(){this.renderForm()}updateLoginPage(){this.getCreator().clearInnerContent(),this.configView(),this.anonimApi=new i.Z}renderForm(){const t=new r.Z({tag:a.Z.SPAN,classNames:[n["login-title"]],textContent:"EXISTING CUSTOMERS"}),e=new r.Z({tag:a.Z.SPAN,classNames:[n["login-subtitle"]],textContent:"Sign Into Best Games"}),s=new r.Z({tag:a.Z.DIV,classNames:[n["login-form"]],textContent:""}),i=new r.Z({tag:a.Z.DIV,classNames:[n["password-block"]],textContent:""}),o=new r.Z({tag:a.Z.BUTTON,classNames:[n.button],textContent:"SHOW"}),l=new r.Z({tag:a.Z.BUTTON,classNames:[n.button],textContent:"SIGN IN"}),d=new r.Z({tag:a.Z.DIV,classNames:[n["registration-field"]],textContent:""}),c=new r.Z({tag:a.Z.SPAN,classNames:[n["registration-field__title"]],textContent:"NEW CUSTOMERS"}),u=new r.Z({tag:a.Z.BUTTON,classNames:[n["register-link"],n.button],textContent:"REGISTER NOW"});s.getElement().setAttribute("action","#"),this.emailElement.setAttribute("type","email"),this.emailElement.setAttribute("name","email"),this.emailElement.setAttribute("placeholder","email"),this.emailElement.setAttribute("Required","true"),this.passwordElement.setAttribute("type","password"),this.passwordElement.setAttribute("name","password"),this.passwordElement.setAttribute("placeholder","password"),this.passwordElement.setAttribute("Required","true"),this.emailElement.addEventListener("input",(()=>this.validateEmail())),this.passwordElement.addEventListener("input",(()=>this.validatePassword())),o.getElement().addEventListener("click",(t=>this.showPassword(t))),l.getElement().addEventListener("click",(t=>this.submitLogin(t))),u.getElement().addEventListener("click",(()=>{this.router.navigate(m._.REGISTRATION)})),s.addInnerElement(t),s.addInnerElement(e),s.addInnerElement(this.loginEmail),i.addInnerElement(this.loginPassword),i.addInnerElement(o),s.addInnerElement(i),s.addInnerElement(l),d.addInnerElement(c),d.addInnerElement(u),this.getCreator().addInnerElement(s),this.getCreator().addInnerElement(d)}showPassword(t){t.preventDefault(),"password"===this.passwordElement.getAttribute("type")?this.passwordElement.setAttribute("type","text"):this.passwordElement.setAttribute("type","password")}async submitLogin(t){t.preventDefault();const e=this.emailElement.value,s=this.passwordElement.value;if(e||(this.emailElement.setCustomValidity(I.FILL_EMAIL),this.emailElement.reportValidity()),s||(this.passwordElement.setCustomValidity(I.FILL_PASSWORD),this.passwordElement.reportValidity()),0!==e.length&&0!==s.length&&this.validatePassword()&&this.validateEmail()){if(void 0!==e)try{if(0===(await this.anonimApi.checkCustomerExist(e)).body.results.length)return this.emailElement.setCustomValidity(I.MAIL_NOT_REGISTERED),void this.emailElement.reportValidity()}catch(t){t instanceof Error&&console.log(t.message)}this.anonimApi.getCustomer({email:e,password:s}).then((t=>{t.body.customer&&(window.localStorage.setItem("isLogin","true"),this.observer.notify(d.Z.LOGIN),this.router.navigate(m._.INDEX),this.userApi=new i.Z({email:e,password:s}),this.userApi.returnCustomerById(t.body.customer.id))})).catch((()=>{this.passwordElement.setCustomValidity(I.PASSWORD_IS_WRONG),this.passwordElement.reportValidity()}))}}validateEmail(){const{value:t}=this.emailElement;switch(this.emailElement.setCustomValidity(""),!0){case!p.test(t):case t.indexOf(" ")>-1:this.emailElement.setCustomValidity(I.EMAIL_CONTAIN_WHITESPACE);break;case!g.test(t):this.emailElement.setCustomValidity(I.EMAIL_WRONG_FORMAT);break;default:return this.emailElement.setCustomValidity(""),!0}return this.emailElement.reportValidity(),!1}validatePassword(){const{value:t}=this.passwordElement;switch(this.passwordElement.setCustomValidity(""),!0){case!p.test(t):this.passwordElement.setCustomValidity(I.PASSWORD_CONTAIN_WHITESPACE);break;case!c.test(t):this.passwordElement.setCustomValidity(I.PASSWORD_NOT_CONTAIN_DIGIT);break;case!u.test(t):this.passwordElement.setCustomValidity(I.PASSWORD_NOT_CONTAIN_LOWER_LETTER);break;case!h.test(t):this.passwordElement.setCustomValidity(I.PASSWORD_NOT_CONTAIN_UPPER_LETTER);break;case!w.test(t):this.passwordElement.setCustomValidity(I.PASSWORD_NOT_CONTAIN_SIMBOLS);break;case!E.test(t):this.passwordElement.setCustomValidity(I.PASSWORD_LENGTH_NOT_ENOUTH);break;default:return this.passwordElement.setCustomValidity(""),!0}return this.passwordElement.reportValidity(),!1}}}}]);